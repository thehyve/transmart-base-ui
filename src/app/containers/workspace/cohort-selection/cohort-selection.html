<div class="main-container">
    <uib-alert class="alert-div" ng-repeat="alert in vm.alerts" type="{{alert.type}}" close="vm.close(alert.id)">
        {{alert.message}}
    </uib-alert>

    <uib-tabset>
        <uib-tab active="vm.tabs[0].active" ng-click="vm.activateTab(tabs[0].title, 'cohortSelection');">
            <uib-tab-heading>
                <span>{{vm.tabs[0].title}}</span>
            </uib-tab-heading>

            <div class="btn-toolbar" role="toolbar">
                <div class="btn-group" role="group">
                    <button type="button"
                            class="btn btn-secondary"
                            ng-click="vm.openSaveCohortModal()"
                            uib-tooltip="Save cohorts"
                            tooltip-trigger="mouseenter"
                            tooltip-placement="top"
                            popupDelay="1000"><span class="glyphicon glyphicon-cloud-upload"></span></button>
                    <button type="button"
                            class="btn btn-secondary"
                            uib-tooltip="Load cohorts"
                            tooltip-trigger="mouseenter"
                            tooltip-placement="top"
                            popupDelay="1000"><span class="glyphicon glyphicon-cloud-download"></span></button>
                    <button type="button"
                            class="btn btn-secondary"
                            uib-tooltip="Refresh"
                            tooltip-trigger="mouseenter"
                            tooltip-placement="top"
                            popupDelay="1000"><span class="glyphicon glyphicon-refresh"></span></button>
                    <button type="button"
                            class="btn btn-secondary"
                            ng-click="vm.resetActiveLabels()"
                            uib-tooltip="Clear"
                            tooltip-trigger="mouseenter"
                            tooltip-placement="top"
                            popupDelay="1000"><span class="glyphicon glyphicon-erase"></span><</button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button"
                            class="btn btn-secondary"
                            uib-tooltip="New workspace"
                            tooltip-trigger="mouseenter"
                            tooltip-placement="top"
                            popupDelay="1000"><span class="glyphicon glyphicon-plus"></span></button>
                    <button type="button"
                            class="btn btn-secondary"
                            uib-tooltip="Close workspace"
                            tooltip-trigger="mouseenter"
                            tooltip-placement="top"
                            popupDelay="1000"><span class="glyphicon glyphicon-remove"></span></button>
                </div>
                <br><br>
            </div>

            <div class="progress-container">
                <uib-progressbar max="100" value="vm.cs.selected/(vm.cs.total/100)"
                                 ng-class="{'progress-striped': vm.cohortUpdating}" class="progress active"
                                 animate="true">
                    <div class="data-count">{{vm.cs.selected}}/{{vm.cs.total}}</div>
                </uib-progressbar>
            </div>

            <div id="main-chart-container" data-drop="true" ng-model='vm.droppedNode'
                 jqyoui-droppable="{
                    multiple:true,
                    onDrop:'vm.onNodeDropEvent(vm.droppedNode)',
                    onOver:'vm.onNodeOver',
                    onOut:'vm.onNodeOut' }"
                 class="text-center main-chart-container">

                <div gridster="vm.gridsterOpts" id="ts-gridster-box">
                    <span ng-if="vm.cohortChartContainerLabels.length == 0" class="ts-well-placeholder-text">
                        Drag and drop nodes here
                    </span>
                    <ul>
                        <li gridster-item="label" ng-repeat="label in vm.cohortChartContainerLabels">
                            <ts-cohort-chart class="chart-container"
                                             ts-gridster-item="gridsterItem"
                                             ts-gridster="gridster"
                                             ts-label="label">
                            </ts-cohort-chart>
                        </li>
                    </ul>
                </div>
            </div>
        </uib-tab>

        <uib-tab active="vm.tabs[1].active" ng-click="vm.activateTab(vm.tabs[1].title, 'cohortGrid');">
            <uib-tab-heading>
                <span>{{vm.tabs[1].title}}</span>
            </uib-tab-heading>
            <!--Cohort grid-->
            <cohort-grid cohort="vm.selectedSubjects" headers="vm.cs.labels" ng-show="vm.cs.labels.length > 0"></cohort-grid>
            <!--Cohort grid no data message-->
            <div class="form-group has-warning" ng-show="vm.cs.labels.length <= 0">
                <span class="help-block">No cohort selected.</span>
            </div>
        </uib-tab>

        <uib-tab active="vm.tabs[2].active" ng-click="vm.activateTab(vm.tabs[2].title, 'cohortView');">
            <uib-tab-heading>
                <span>{{vm.tabs[2].title}}</span>
            </uib-tab-heading>

            <cohort-view ng-if="vm.tabs[2].active"></cohort-view>

        </uib-tab>

    </uib-tabset>
</div>

